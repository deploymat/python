# Caddy Demo Projects

This repository contains two demo projects that showcase different approaches to configuring Caddy as a reverse proxy with Docker.

## Project 1: Static Configuration with Caddyfile

Location: `1-caddyfile/`

A simple static website served by Caddy using a traditional Caddyfile for configuration.

### Features:
- Static file serving
- Automatic HTTPS with local certificates
- HTTP/2 enabled
- Security headers
- Gzip compression

### Quick Start:

1. Navigate to the project directory:
   ```bash
   cd 1-caddyfile
   ```

2. Run the setup script to generate local certificates:
   ```bash
   ./setup.sh
   ```

3. Start the services:
   ```bash
   docker-compose up -d
   ```

4. Open in your browser: [https://localhost](https://localhost)

## Project 2: Dynamic Configuration with Docker Labels

Location: `2-docker-labels/`

A more advanced setup that uses Docker labels to dynamically configure Caddy as a reverse proxy for multiple services.

### Features:
- Automatic service discovery
- Dynamic reverse proxy configuration
- Multiple services with automatic HTTPS
- Global middleware support
- Health checks

### Quick Start:

1. Navigate to the project directory:
   ```bash
   cd 2-docker-labels
   ```

2. Run the setup script (requires sudo to modify /etc/hosts):
   ```bash
   sudo ./setup.sh
   ```

3. Start the services:
   ```bash
   docker-compose up -d --build
   ```

4. Access the services:
   - Web: [https://web.demo.local](https://web.demo.local)
   - API: [https://api.demo.local](https://api.demo.local)

   Note: You may need to accept the self-signed certificate in your browser.

## Requirements

- Docker and Docker Compose
- For local development certificates: `mkcert` (installed automatically by the setup scripts)

## Project Structure

```
caddy-demo/
├── 1-caddyfile/           # Static Caddy configuration
│   ├── Caddyfile          # Caddy configuration
│   ├── docker-compose.yml # Docker Compose configuration
│   ├── html/              # Static website files
│   │   └── index.html
│   ├── certs/             # SSL certificates (generated by setup)
│   └── setup.sh           # Setup script for local certificates
│
└── 2-docker-labels/      # Dynamic configuration with Docker labels
    ├── docker-compose.yml # Docker Compose with Caddy proxy
    ├── api/               # Python API service
    │   ├── app.py
    │   ├── Dockerfile
    │   └── requirements.txt
    ├── web/               # Static web files
    │   └── index.html
    └── setup.sh           # Setup script for local development
```

## Troubleshooting

### Certificate Warnings
If you see certificate warnings in your browser:
1. For local development, install the local CA certificate generated by mkcert:
   ```bash
   mkcert -install
   ```
2. For the demo.local domains, you'll need to accept the self-signed certificate in your browser.

### Port Conflicts
If you get port conflicts (80 or 443 already in use):
1. Stop any other web servers running on these ports
2. Or modify the port mappings in the docker-compose.yml files

## License

Apache 2
